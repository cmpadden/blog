<!DOCTYPE html>
<html>

<head>
    
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="description" content="Personal technical diary">
<title>
Docker Volume Permissions with SELinux - Technical Log
</title>




<link rel="shortcut icon" href="/blog/favicon.ico">








<link rel="stylesheet" href="/blog/css/main.min.81bbafc4df93b11c1c3e2449464373c384aa4903731b4fc7a77dfcdd979e184f.css" integrity="sha256-gbuvxN&#43;TsRwcPiRJRkNzw4SqSQNzG0/Hp3383ZeeGE8=" crossorigin="anonymous" media="screen">



 

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Didact+Gothic">

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://cmpadden.github.io/blog/tn.png"/>

<meta name="twitter:title" content="Docker Volume Permissions with SELinux"/>
<meta name="twitter:description" content="Unfamiliar with running Docker on a SELinux enabled system, I found myself running into a bunch of file permission errors while creating volumes.
mkdir: can&#39;t create directory &#39;/data&#39;: Permission denied $ docker info --format &#39;{{json .SecurityOptions}}&#39; [ &#34;name=seccomp,profile=/etc/docker/seccomp.json&#34;, &#34;name=selinux&#34; ] It turns out that this can be resolved by appending the :z flag to the volume mappings in the docker-compose.yml file, indicating that the volume content is shared.
services: server: volumes: - ."/>

<meta property="og:title" content="Docker Volume Permissions with SELinux" />
<meta property="og:description" content="Unfamiliar with running Docker on a SELinux enabled system, I found myself running into a bunch of file permission errors while creating volumes.
mkdir: can&#39;t create directory &#39;/data&#39;: Permission denied $ docker info --format &#39;{{json .SecurityOptions}}&#39; [ &#34;name=seccomp,profile=/etc/docker/seccomp.json&#34;, &#34;name=selinux&#34; ] It turns out that this can be resolved by appending the :z flag to the volume mappings in the docker-compose.yml file, indicating that the volume content is shared.
services: server: volumes: - ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cmpadden.github.io/blog/posts/docker-selinux-volumes/" />

<meta property="og:image" content="https://cmpadden.github.io/blog/tn.png" />
<meta property="article:published_time" content="2019-12-26T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-12-26T00:00:00+00:00" /><meta property="og:site_name" content="Technical Diary" />


    

    
    
    
    <title>
        
        Docker Volume Permissions with SELinux
        
    </title>
</head>

<body>
    <div class="wrap">
        <div class="section" id="title">Docker Volume Permissions with SELinux</div>

        
<div class="section" id="content">
    Thu Dec 26, 2019 &#183; 119 words
    
    <div class="tag-container">
        
        <span class="tag">
            <a href="https://cmpadden.github.io/blog/tags/docker">
                docker
            </a>
        </span>
        
        <span class="tag">
            <a href="https://cmpadden.github.io/blog/tags/selinux">
                selinux
            </a>
        </span>
        
    </div>
    
    <hr/>
    <p>Unfamiliar with running Docker on a SELinux enabled system, I found myself
running into a bunch of file permission errors while creating volumes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">mkdir: can&#39;t create directory &#39;/data&#39;: Permission denied</code></pre></div>
<hr />
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker info --format <span style="color:#e6db74">&#39;{{json .SecurityOptions}}&#39;</span>
<span style="color:#f92672">[</span>
  <span style="color:#e6db74">&#34;name=seccomp,profile=/etc/docker/seccomp.json&#34;</span>,
  <span style="color:#e6db74">&#34;name=selinux&#34;</span>
<span style="color:#f92672">]</span></code></pre></div>
<p>It turns out that this can be resolved by appending the <code>:z</code> flag to the volume
mappings in the <code>docker-compose.yml</code> file, indicating that the volume content
is shared.</p>

<pre><code>services:
  server:
    volumes:
      - ./data:/data:z
</code></pre>

<p>From the Docker documentation:</p>

<blockquote>
<p>The <code>z</code> option tells Docker that two containers share the volume content. As
a result, Docker labels the content with a shared content label. Shared
volume labels allow all containers to read/write content.</p>
</blockquote>

<p><strong>References</strong></p>

<ul>
<li><a href="https://docs.docker.com/engine/reference/commandline/info/">Docker Docs: Docker Info</a></li>
<li><a href="https://docs.docker.com/engine/reference/commandline/run/#mount-volumes-from-container---volumes-from">Docker Docs: Mounting Volumes</a></li>
</ul>

</div>


        
<div class="section bottom-menu">
    
<hr />
<p>


    
        <a href="/blog/posts">back</a>
        
            &#183;
        
    

    
        
            <a href="/blog/posts">Posts</a>
        
    
    
    &#183; 
    <a href="https://cmpadden.github.io/blog/">
        main
    </a>

</p>
</div>


        <div class="section footer">The troubleshooting log</div>
    </div>
</body>

</html>